const d=(e,u,i)=>{const t=e.createShader(e[i]);return e.shaderSource(t,u),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)?t:(console.error(e.getShaderInfoLog(t)),null)},m=(e,u,i,t,o)=>{const a=e.createProgram(),s=d(e,u,"VERTEX_SHADER"),T=d(e,i,"FRAGMENT_SHADER");e.attachShader(a,s),e.attachShader(a,T),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)||console.error("Could not initialize shaders"),e.deleteShader(s),e.deleteShader(T);let R;if(t.length)R=t.reduce((r,E)=>(r[E]=e.getAttribLocation(a,E),r),{});else{const r=e.getProgramParameter(a,e.ACTIVE_ATTRIBUTES),E={};for(let f=0;f<r;f++){const c=e.getActiveAttrib(a,f);E[c.name]=e.getAttribLocation(a,c.name)}R=E}let b;if(o.length)b=o.reduce((r,E)=>(r[E]=e.getUniformLocation(a,E),r),{});else{const r=e.getProgramParameter(a,e.ACTIVE_UNIFORMS),E={};for(let f=0;f<r;f++){const c=e.getActiveUniform(a,f);E[c.name]=e.getUniformLocation(a,c.name)}b=E}const n={data:a,attributes:R,uniforms:b,use:()=>{e.useProgram(a)},dispose:()=>{e.deleteProgram(a),Object.values(R).forEach(r=>{e.disableVertexAttribArray(r)})},getUniform:r=>e.getUniform(a,n.uniforms[r]),setUniform:(r,E,f)=>{switch(E){case"float":e.uniform1f(n.uniforms[r],f);break;case"int":e.uniform1i(n.uniforms[r],f);break;case"bool":e.uniform1f(n.uniforms[r],f);break;case"vec2":e.uniform2fv(n.uniforms[r],f);break;case"ivec2":e.uniform2iv(n.uniforms[r],f);break;case"bvec2":e.uniform2fv(n.uniforms[r],f);break;case"vec3":e.uniform3fv(n.uniforms[r],f);break;case"ivec3":e.uniform3iv(n.uniforms[r],f);break;case"bvec3":e.uniform3fv(n.uniforms[r],f);break;case"vec4":e.uniform4fv(n.uniforms[r],f);break;case"ivec4":e.uniform4iv(n.uniforms[r],f);break;case"bvec4":e.uniform4fv(n.uniforms[r],f);break;case"mat2":e.uniformMatrix2fv(n.uniforms[r],!1,f);break;case"mat3":e.uniformMatrix3fv(n.uniforms[r],!1,f);break;case"mat4":e.uniformMatrix4fv(n.uniforms[r],!1,f);break;case"sampler2D":e.uniform1i(n.uniforms[r],f);break;case"samplerCube":e.uniform1i(n.uniforms[r],f);break}}};return n},A=(e,u,i,t)=>{const o=e.createVertexArray();e.bindVertexArray(o);const a=[];i.forEach(({name:R,data:b,size:n})=>{const r=e.createBuffer();a.push(r),e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array(b),e.STATIC_DRAW),e.vertexAttribPointer(u.attributes[R],n,e.FLOAT,!1,0,0),e.enableVertexAttribArray(u.attributes[R])});let s=null;t&&(s=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),e.STATIC_DRAW)),e.bindVertexArray(null),e.bindBuffer(e.ARRAY_BUFFER,null),t&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);const T={vao:o,use:R=>{e.bindVertexArray(T.vao),R(t?t.length:void 0),e.bindVertexArray(null)},dispose:()=>{e.deleteVertexArray(T.vao),a.forEach(R=>{e.deleteBuffer(R)}),e.deleteBuffer(s)}};return T},F=(e,u,i)=>{u.use(t=>{t!=null?e.drawElements(e[i],t,e.UNSIGNED_SHORT,0):e.drawArrays(e[i],e.UNSIGNED_SHORT,0)})},U=(e,u)=>{const i=e.createTexture(),t=new Image;return t.onload=()=>{e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null)},t.src=u,{use(o){e.bindTexture(e.TEXTURE_2D,i),o(),e.bindTexture(e.TEXTURE_2D,null)},set(o){t.src=o},bind(o){e.activeTexture(e[`TEXTURE${o}`]),e.bindTexture(e.TEXTURE_2D,i)},dispose(){e.deleteTexture(i)}}},_=(e,u,i,t)=>{const o=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,o),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,u,i);const a=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,o),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),{buffer:a,texture:t,use:s=>{e.bindFramebuffer(e.FRAMEBUFFER,a),s(),e.bindFramebuffer(e.FRAMEBUFFER,null)},resize:(s,T)=>{e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,s,T,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindRenderbuffer(e.RENDERBUFFER,o),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,s,T),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null)},dispose:()=>{e.deleteTexture(t),e.deleteFramebuffer(a),e.deleteRenderbuffer(o)}}};export{A as a,_ as b,m as c,F as d,U as l};
