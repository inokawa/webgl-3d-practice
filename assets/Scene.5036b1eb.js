import{A as L}from"./mat4.356e1817.js";import{a as N}from"./index.a9c1d5ea.js";import{a as T,l as k}from"./webgl.33373512.js";function P(){var s=new L(3);return L!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Y(s,e){return s[0]=e[0],s[1]=e[1],s[2]=e[2],s}function B(s,e){return s[0]=-e[0],s[1]=-e[1],s[2]=-e[2],s}function _(s,e){var t=e[0],r=e[1],o=e[2],i=t*t+r*r+o*o;return i>0&&(i=1/Math.sqrt(i)),s[0]=e[0]*i,s[1]=e[1]*i,s[2]=e[2]*i,s}(function(){var s=P();return function(e,t,r,o,i,c){var n,a;for(t||(t=3),r||(r=0),o?a=Math.min(o*t+r,e.length):a=e.length,n=r;n<a;n+=t)s[0]=e[n],s[1]=e[n+1],s[2]=e[n+2],i(s,s,c),e[n]=s[0],e[n+1]=s[1],e[n+2]=s[2];return e}})();class D{constructor(e,t){this.gl=e,this.program=t,this.objects=[]}start(e){let t=!0,r;const o=()=>{r=requestAnimationFrame(a=>{!t||(e(this.objects,a),o())})},i=()=>{t=!1,r!=null&&cancelAnimationFrame(r)};o();const c=()=>{t=!0,o(),console.info("Clock resumed")},n=()=>{i(),console.info("Clock stopped")};return window.addEventListener("focus",c),window.addEventListener("blur",n),this.stop=()=>{window.removeEventListener("focus",c),window.removeEventListener("blur",n),i()}}get(e){return this.objects.find(t=>t.alias===e)}add(e,t,r){var x,j,g,v,w,O,V,C,E,R,A,y,z,K,F;const{gl:o,program:i}=this,c=(x=e.vertices)!=null?x:[],n=(j=e.indices)!=null?j:[],a=(g=e.scalars)!=null?g:[],d=(v=e.textureCoords)!=null?v:[],u=(w=e.diffuse)!=null?w:[1,1,1,1],h=(O=e.ambient)!=null?O:[.2,.2,.2,1],p=(V=e.specular)!=null?V:[1,1,1,1],f=(C=e.specularExponent)!=null?C:0,m=(E=e.d)!=null?E:1,l=[];"aVertexPosition"in i.attributes&&c.length&&l.push({name:"aVertexPosition",data:c,size:3}),"aVertexNormal"in i.attributes&&c.length&&n.length&&l.push({name:"aVertexNormal",data:N(c,n),size:3}),"aVertexColor"in i.attributes&&a.length&&l.push({name:"aVertexColor",data:a,size:4}),"aVertexTextureCoords"in i.attributes&&d.length&&l.push({name:"aVertexTextureCoords",data:d,size:2});const b={alias:(R=e.alias)!=null?R:t,vertices:c,indices:n,scalars:a,textureCoords:d,wireframe:(A=e.wireframe)!=null?A:!1,diffuse:u,Kd:(y=e.Kd)!=null?y:u.slice(0,3),ambient:h,Ka:e.Ka||h.slice(0,3),specular:p,Ks:e.Ks||p.slice(0,3),specularExponent:f,Ns:(z=e.Ns)!=null?z:f,d:m,transparency:(K=e.transparency)!=null?K:m,illum:(F=e.illum)!=null?F:1,vao:T(o,i,l,n),...r};e.image&&(b.texture=k(o,e.image)),this.objects.push(b)}traverse(e){for(let t=0;t<this.objects.length&&e(this.objects[t],t)===void 0;t++);}renderFirst(e){const t=this.get(e),r=this.objects.indexOf(t);r!==0&&(this.objects.splice(r,1),this.objects.splice(0,0,t),this.printRenderOrder())}renderLast(e){const t=this.get(e),r=this.objects.indexOf(t);r!==0&&(this.objects.splice(r,1),this.objects.push(t),this.printRenderOrder())}renderSooner(e){const t=this.get(e),r=this.objects.indexOf(t);r!==0&&(this.objects.splice(r,1),this.objects.splice(r-1,0,t),this.printRenderOrder())}printRenderOrder(){const e=this.objects.map(t=>t.alias).join(" > ");console.info("Render Order:",e)}dispose(){var e;(e=this.stop)==null||e.call(this),this.program.dispose(),this.objects.forEach(t=>{var r;t.vao.dispose(),(r=t.texture)==null||r.dispose()})}}export{D as S,P as a,_ as b,Y as c,B as n};
