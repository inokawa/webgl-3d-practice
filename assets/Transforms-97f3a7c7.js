var m=Object.defineProperty;var h=(r,t,i)=>t in r?m(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i;var a=(r,t,i)=>(h(r,typeof t!="symbol"?t+"":t,i),i);import{c as s,a as e,b as c,d as l,p as n}from"./mat4-e742a724.js";class M{constructor(t,i,o){a(this,"program");a(this,"camera");a(this,"canvas");a(this,"stack");a(this,"modelViewMatrix");a(this,"projectionMatrix");a(this,"normalMatrix");this.stack=[],this.program=t,this.camera=i,this.canvas=o,this.modelViewMatrix=s(),this.projectionMatrix=s(),this.normalMatrix=s(),this.calculateModelView(),this.updatePerspective(),this.calculateNormal()}calculateModelView(){this.modelViewMatrix=this.camera.getViewTransform()}calculateNormal(){e(this.normalMatrix,this.modelViewMatrix),c(this.normalMatrix,this.normalMatrix),l(this.normalMatrix,this.normalMatrix)}updatePerspective(){n(this.projectionMatrix,this.camera.fov,this.canvas.width/this.canvas.height,this.camera.minZ,this.camera.maxZ)}setMatrixUniforms(){this.calculateNormal(),this.program.setUniform("uModelViewMatrix","mat4",this.modelViewMatrix),this.program.setUniform("uProjectionMatrix","mat4",this.projectionMatrix),this.program.setUniform("uNormalMatrix","mat4",this.normalMatrix)}push(){const t=s();e(t,this.modelViewMatrix),this.stack.push(t)}pop(){return this.stack.length?this.modelViewMatrix=this.stack.pop():null}}export{M as T};
