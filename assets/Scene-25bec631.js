var j=Object.defineProperty;var g=(a,e,t)=>e in a?j(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var d=(a,e,t)=>(g(a,typeof e!="symbol"?e+"":e,t),t);import{a as v,f as V}from"./index-87fda849.js";import{a as w,l as O}from"./webgl-ec7981e3.js";class R{constructor(e,t){d(this,"gl");d(this,"program");d(this,"objects");d(this,"stop");this.gl=e,this.program=t,this.objects=[]}start(e){let t=!0,s;const o=()=>{s=requestAnimationFrame(l=>{!t||(e(this.objects,l),o())})},r=()=>{t=!1,s!=null&&cancelAnimationFrame(s)};o();const i=()=>{t=!0,o(),console.info("Clock resumed")},n=()=>{r(),console.info("Clock stopped")};return window.addEventListener("focus",i),window.addEventListener("blur",n),this.stop=()=>{window.removeEventListener("focus",i),window.removeEventListener("blur",n),r()}}get(e){return this.objects.find(t=>t.alias===e)}add(e,t,s){const{gl:o,program:r}=this,i=e.vertices??[],n=e.indices??[],l=e.scalars??[],u=e.textureCoords??[],h=e.diffuse??[1,1,1,1],p=e.ambient??[.2,.2,.2,1],b=e.specular??[1,1,1,1],f=e.specularExponent??0,m=e.d??1,c=[];"aVertexPosition"in r.attributes&&i.length&&c.push({name:"aVertexPosition",data:i,size:3}),"aVertexNormal"in r.attributes&&i.length&&n.length&&c.push({name:"aVertexNormal",data:v(i,n),size:3}),"aVertexColor"in r.attributes&&l.length&&c.push({name:"aVertexColor",data:l,size:4}),"aVertexTextureCoords"in r.attributes&&u.length&&(c.push({name:"aVertexTextureCoords",data:u,size:2}),"aVertexTangent"in r.attributes&&c.push({name:"aVertexTangent",data:V(i,u,n),size:3}));const x={alias:e.alias??t,visible:e.visible??!0,vertices:i,indices:n,scalars:l,textureCoords:u,wireframe:e.wireframe??!1,diffuse:h,Kd:e.Kd??h.slice(0,3),ambient:p,Ka:e.Ka||p.slice(0,3),specular:b,Ks:e.Ks||b.slice(0,3),specularExponent:f,Ns:e.Ns??f,d:m,transparency:e.transparency??m,illum:e.illum??1,vao:w(o,r,c,n),...s};e.image&&(x.texture=O(o,e.image)),this.objects.push(x)}traverse(e){for(let t=0;t<this.objects.length&&!e(this.objects[t],t);t++);}renderFirst(e){const t=this.get(e),s=this.objects.indexOf(t);s!==0&&(this.objects.splice(s,1),this.objects.splice(0,0,t),this.printRenderOrder())}renderLast(e){const t=this.get(e),s=this.objects.indexOf(t);s!==0&&(this.objects.splice(s,1),this.objects.push(t),this.printRenderOrder())}renderSooner(e){const t=this.get(e),s=this.objects.indexOf(t);s!==0&&(this.objects.splice(s,1),this.objects.splice(s-1,0,t),this.printRenderOrder())}printRenderOrder(){const e=this.objects.map(t=>t.alias).join(" > ");console.info("Render Order:",e)}dispose(){var e;(e=this.stop)==null||e.call(this),this.program.dispose(),this.objects.forEach(t=>{var s;t.vao.dispose(),(s=t.texture)==null||s.dispose()})}}export{R as S};
