import{A as K}from"./mat4.356e1817.js";import{a as L}from"./index.d7b26453.js";import{a as N}from"./webgl.68fb3a22.js";function k(){var s=new K(3);return K!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function q(s,e){return s[0]=e[0],s[1]=e[1],s[2]=e[2],s}function M(s,e){return s[0]=-e[0],s[1]=-e[1],s[2]=-e[2],s}function Y(s,e){var t=e[0],r=e[1],o=e[2],n=t*t+r*r+o*o;return n>0&&(n=1/Math.sqrt(n)),s[0]=e[0]*n,s[1]=e[1]*n,s[2]=e[2]*n,s}(function(){var s=k();return function(e,t,r,o,n,c){var i,a;for(t||(t=3),r||(r=0),o?a=Math.min(o*t+r,e.length):a=e.length,i=r;i<a;i+=t)s[0]=e[i],s[1]=e[i+1],s[2]=e[i+2],n(s,s,c),e[i]=s[0],e[i+1]=s[1],e[i+2]=s[2];return e}})();class B{constructor(e,t){this.gl=e,this.program=t,this.objects=[]}start(e){let t=!0,r;const o=()=>{r=requestAnimationFrame(a=>{!t||(e(this.objects,a),o())})},n=()=>{t=!1,r!=null&&cancelAnimationFrame(r)};o();const c=()=>{t=!0,o(),console.info("Clock resumed")},i=()=>{n(),console.info("Clock stopped")};return window.addEventListener("focus",c),window.addEventListener("blur",i),this.stop=()=>{window.removeEventListener("focus",c),window.removeEventListener("blur",i),n()}}get(e){return this.objects.find(t=>t.alias===e)}add(e,t){var m,b,x,j,v,g,w,O,V,C,E,R,A,y,z;const{gl:r,program:o}=this,n=(m=e.vertices)!=null?m:[],c=(b=e.indices)!=null?b:[],i=(x=e.scalars)!=null?x:[],a=(j=e.textureCoords)!=null?j:[],d=(v=e.diffuse)!=null?v:[1,1,1,1],h=(g=e.ambient)!=null?g:[.2,.2,.2,1],u=(w=e.specular)!=null?w:[1,1,1,1],p=(O=e.specularExponent)!=null?O:0,f=(V=e.d)!=null?V:1,l=[];"aVertexPosition"in o.attributes&&n.length&&l.push({name:"aVertexPosition",data:n,size:3}),"aVertexNormal"in o.attributes&&n.length&&c.length&&l.push({name:"aVertexNormal",data:L(n,c),size:3}),"aVertexColor"in o.attributes&&i.length&&l.push({name:"aVertexColor",data:i,size:4}),"aVertexTextureCoords"in o.attributes&&a.length&&l.push({name:"aVertexTextureCoords",data:a,size:2});const F={alias:(C=e.alias)!=null?C:t,vertices:n,indices:c,scalars:i,textureCoords:a,wireframe:(E=e.wireframe)!=null?E:!1,diffuse:d,Kd:(R=e.Kd)!=null?R:d.slice(0,3),ambient:h,Ka:e.Ka||h.slice(0,3),specular:u,Ks:e.Ks||u.slice(0,3),specularExponent:p,Ns:(A=e.Ns)!=null?A:p,d:f,transparency:(y=e.transparency)!=null?y:f,illum:(z=e.illum)!=null?z:1,vao:N(r,o,l,c)};this.objects.push(F)}traverse(e){for(let t=0;t<this.objects.length&&e(this.objects[t],t)===void 0;t++);}renderFirst(e){const t=this.get(e),r=this.objects.indexOf(t);r!==0&&(this.objects.splice(r,1),this.objects.splice(0,0,t),this.printRenderOrder())}renderLast(e){const t=this.get(e),r=this.objects.indexOf(t);r!==0&&(this.objects.splice(r,1),this.objects.push(t),this.printRenderOrder())}renderSooner(e){const t=this.get(e),r=this.objects.indexOf(t);r!==0&&(this.objects.splice(r,1),this.objects.splice(r-1,0,t),this.printRenderOrder())}printRenderOrder(){const e=this.objects.map(t=>t.alias).join(" > ");console.info("Render Order:",e)}dispose(){var e;(e=this.stop)==null||e.call(this),this.program.dispose(),this.objects.forEach(t=>{t.vao.dispose()})}}export{B as S,k as a,Y as b,q as c,M as n};
